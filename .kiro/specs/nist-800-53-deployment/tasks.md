# Implementation Plan

- [x] 1. Create NIST 800-53 focused directory structure


  - Create Definitions/policyAssignments/ folder (required for NIST 800-53 assignments)
  - Create Definitions/policyDocumentations/ folder (optional - for compliance reports)
  - Create Definitions/policyExemptions/ folder (optional - for managing exemptions)
  - Create .github/workflows/ folder for GitHub Actions automation
  - Add Output/ to .gitignore (auto-generated by EPAC during plan generation)
  - Note: policyDefinitions and policySetDefinitions NOT needed - NIST 800-53 is built-in Azure policy
  - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5_



- [ ] 2. Configure global settings for NIST 800-53 deployment
  - Create Definitions/global-settings.jsonc with epac-dev and tenant environments
  - Configure deployment root scopes for each environment
  - Set desired state strategy (ownedOnly for dev, full for prod)
  - Configure managed identity locations


  - Generate unique pacOwnerId GUID
  - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5_

- [ ] 3. Create NIST 800-53 policy assignment configuration
  - Create Definitions/policyAssignments/nist-800-53-assignments.jsonc
  - Configure policy set reference (ID: 179d1daa-458f-4e47-8086-2a68d0d6c38f)


  - Define hierarchical node structure with Prod and Nonprod children
  - Configure scope mappings for epac-dev and tenant environments
  - Set parameter selectors for prod and nonprod
  - _Requirements: 1.1, 1.5, 9.1, 9.2, 9.3, 9.4_

- [ ] 4. Create NIST 800-53 parameter CSV file
  - Create Definitions/policyAssignments/nist-800-53-parameters.csv
  - Extract only NIST 800-53 policies (groupNames containing "NIST_SP_800-53_R5") from StarterKit example




  - Remove all Azure Security Benchmark (ASB) policies
  - Remove all PCI-DSS policies
  - Remove all other compliance framework policies
  - Configure prodEffect and nonprodEffect columns (start with Audit for safe initial deployment)
  - Keep only policies with "NIST-800-53" in policySets column
  - _Requirements: 1.2, 1.3, 1.4, 7.1, 7.2, 7.3, 7.4_



- [ ] 5. Create GitHub Actions reusable workflow templates
- [ ] 5.1 Create plan workflow template
  - Create .github/workflows/plan.yml
  - Configure workflow inputs (pacEnvironmentSelector, planGitHubEnvironment, folders)
  - Add checkout, PowerShell module installation, and Azure login steps


  - Implement Build-DeploymentPlans execution
  - Add plan detection logic and output variables
  - Configure artifact upload for plan files
  - _Requirements: 2.1, 2.6, 8.1, 8.2, 8.3_



- [ ] 5.2 Create policy deployment workflow template
  - Create .github/workflows/deploy-policy.yml
  - Configure workflow inputs and artifact download
  - Add Azure login with OIDC
  - Implement Deploy-PolicyPlan execution


  - _Requirements: 2.3, 2.6, 6.1_

- [ ] 5.3 Create roles deployment workflow template
  - Create .github/workflows/deploy-roles.yml
  - Configure workflow inputs and artifact download
  - Add Azure login with OIDC


  - Implement Deploy-RolesPlan execution
  - _Requirements: 2.3, 2.6, 6.1_

- [ ] 6. Create epac-dev workflow
  - Create .github/workflows/epac-dev-workflow.yml
  - Configure trigger on PR to main with Definitions/ path filter
  - Call plan template with epac-dev environment
  - Call deploy-policy template (no approval required)
  - Call deploy-roles template (no approval required)


  - _Requirements: 2.1, 2.2, 2.3, 4.1_

- [ ] 7. Create tenant (production) workflow
  - Create .github/workflows/epac-tenant-workflow.yml
  - Configure trigger on PR merge to main with Definitions/ path filter
  - Call plan template with tenant environment


  - Call deploy-policy template with approval gate
  - Call deploy-roles template with approval gate
  - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 4.2_

- [ ] 8. Create local deployment documentation
  - Create README.md with setup instructions


  - Document service principal creation and permission assignment
  - Document GitHub environment setup with OIDC configuration
  - Document local script usage for Build-DeploymentPlans
  - Document local script usage for Deploy-PolicyPlan
  - Document local script usage for Deploy-RolesPlan
  - Include authentication methods (service principal, user, certificate)

  - Add troubleshooting section for common issues
  - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 5.6, 6.2, 6.3, 6.4_

- [ ] 9. Configure GitHub repository settings
  - Document creation of GitHub environments (EPAC-DEV, TENANT-PLAN, TENANT-DEPLOY-POLICY, TENANT-DEPLOY-ROLES)
  - Document adding environment secrets (AZURE_CLIENT_ID, AZURE_TENANT_ID)
  - Document configuring required reviewers for TENANT-DEPLOY-POLICY and TENANT-DEPLOY-ROLES
  - Document branch protection rules for main branch
  - Document environment branch restrictions to main
  - _Requirements: 2.4, 2.5, 6.5_

- [ ] 10. Create deployment validation checklist
  - Create DEPLOYMENT.md with pre-deployment checklist
  - Document plan review process
  - Document approval workflow for production deployments
  - Document rollback procedures using git history
  - Include compliance validation steps
  - _Requirements: 8.3, 8.4, 8.5_

- [ ] 11. Create service principal setup guide
  - Create SERVICE_PRINCIPALS.md documentation
  - Document required permissions (Reader, Policy Contributor, RBAC Administrator)
  - Document federated credential configuration for GitHub OIDC
  - Document scope assignment to management groups
  - Include PowerShell scripts for service principal creation
  - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 12. Verify NIST 800-53 only repository structure


  - Verify .gitignore includes Output/ folder
  - Verify Definitions/policyAssignments/ contains only NIST 800-53 files (no ASB, PCI-DSS, or other frameworks)
  - Verify Definitions/ folder structure: global-settings.jsonc, policyAssignments/, policyDocumentations/ (optional), policyExemptions/ (optional)
  - Confirm NO policyDefinitions/ or policySetDefinitions/ folders exist (not needed for built-in NIST 800-53)
  - Note: StarterKit folder can remain as reference but EPAC only reads from Definitions/
  - _Requirements: 1.2, 1.3, 1.4, 5.1, 5.2, 5.3, 5.4, 5.5_
